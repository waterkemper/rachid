"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const express_1 = require("express");
const ParticipanteController_1 = require("../controllers/ParticipanteController");
const GrupoController_1 = require("../controllers/GrupoController");
const DespesaController_1 = require("../controllers/DespesaController");
const RelatorioController_1 = require("../controllers/RelatorioController");
const ParticipacaoController_1 = require("../controllers/ParticipacaoController");
const GrupoParticipantesController_1 = require("../controllers/GrupoParticipantesController");
const GrupoMaiorController_1 = require("../controllers/GrupoMaiorController");
const AuthController_1 = require("../controllers/AuthController");
const PublicEventoController_1 = require("../controllers/PublicEventoController");
const TemplateController_1 = require("../controllers/TemplateController");
const AdminController_1 = require("../controllers/AdminController");
const auth_1 = require("../middleware/auth");
const requireGroupMember_1 = require("../middleware/requireGroupMember");
const requireAdmin_1 = require("../middleware/requireAdmin");
const AnalyticsController_1 = require("../controllers/AnalyticsController");
const router = (0, express_1.Router)();
// Rotas públicas (sem autenticação)
router.post('/auth/login', AuthController_1.AuthController.login);
router.post('/auth/google', AuthController_1.AuthController.googleLogin);
router.post('/auth/logout', AuthController_1.AuthController.logout);
router.post('/auth/create-user', AuthController_1.AuthController.createUser);
router.post('/auth/solicitar-recuperacao-senha', AuthController_1.AuthController.solicitarRecuperacaoSenha);
router.post('/auth/validar-token-recuperacao', AuthController_1.AuthController.validarTokenRecuperacao);
router.post('/auth/resetar-senha', AuthController_1.AuthController.resetarSenha);
// Rotas públicas de eventos (sem autenticação)
router.get('/public/eventos/:token', PublicEventoController_1.PublicEventoController.getByToken);
router.get('/public/eventos/:token/saldos', PublicEventoController_1.PublicEventoController.getSaldosByToken);
router.get('/public/eventos/:token/saldos-por-grupo', PublicEventoController_1.PublicEventoController.getSaldosPorGrupoByToken);
router.get('/public/eventos/:token/sugestoes', PublicEventoController_1.PublicEventoController.getSugestoesByToken);
router.get('/public/eventos/:token/despesas', PublicEventoController_1.PublicEventoController.getDespesasByToken);
// Rotas de templates (públicas, não requerem autenticação)
router.get('/templates', TemplateController_1.TemplateController.getAll);
router.get('/templates/:id', TemplateController_1.TemplateController.getById);
// Rotas protegidas (requerem autenticação)
router.get('/auth/me', auth_1.authMiddleware, AuthController_1.AuthController.me);
router.put('/auth/me', auth_1.authMiddleware, AuthController_1.AuthController.updateUser);
router.post('/analytics/event', auth_1.authMiddleware, AnalyticsController_1.AnalyticsController.track);
router.get('/participantes', auth_1.authMiddleware, ParticipanteController_1.ParticipanteController.getAll);
router.get('/participantes/:id', auth_1.authMiddleware, ParticipanteController_1.ParticipanteController.getById);
router.post('/participantes', auth_1.authMiddleware, ParticipanteController_1.ParticipanteController.create);
router.put('/participantes/:id', auth_1.authMiddleware, ParticipanteController_1.ParticipanteController.update);
router.delete('/participantes/:id', auth_1.authMiddleware, ParticipanteController_1.ParticipanteController.delete);
router.get('/grupos', auth_1.authMiddleware, GrupoController_1.GrupoController.getAll);
router.get('/grupos/:id', auth_1.authMiddleware, GrupoController_1.GrupoController.getById);
router.post('/grupos', auth_1.authMiddleware, GrupoController_1.GrupoController.create);
router.put('/grupos/:id', auth_1.authMiddleware, GrupoController_1.GrupoController.update);
router.delete('/grupos/:id', auth_1.authMiddleware, GrupoController_1.GrupoController.delete);
router.post('/grupos/:id/duplicar', auth_1.authMiddleware, GrupoController_1.GrupoController.duplicar);
router.post('/grupos/:id/participantes', auth_1.authMiddleware, GrupoController_1.GrupoController.adicionarParticipante);
router.delete('/grupos/:id/participantes', auth_1.authMiddleware, GrupoController_1.GrupoController.removerParticipante);
router.post('/grupos/:id/gerar-link', auth_1.authMiddleware, GrupoController_1.GrupoController.gerarLink);
router.get('/grupos/:id/link', auth_1.authMiddleware, GrupoController_1.GrupoController.obterLink);
router.get('/despesas', auth_1.authMiddleware, DespesaController_1.DespesaController.getAll);
router.get('/despesas/:id', auth_1.authMiddleware, DespesaController_1.DespesaController.getById);
router.post('/despesas', auth_1.authMiddleware, requireGroupMember_1.requireGroupMember, DespesaController_1.DespesaController.create);
router.put('/despesas/:id', auth_1.authMiddleware, requireGroupMember_1.requireGroupMember, DespesaController_1.DespesaController.update);
router.delete('/despesas/:id', auth_1.authMiddleware, requireGroupMember_1.requireGroupMember, DespesaController_1.DespesaController.delete);
router.get('/grupos/:id/saldos', auth_1.authMiddleware, RelatorioController_1.RelatorioController.getSaldosGrupo);
router.get('/grupos/:id/saldos-por-grupo', auth_1.authMiddleware, RelatorioController_1.RelatorioController.getSaldosPorGrupo);
router.get('/grupos/:id/sugestoes-pagamento-grupos', auth_1.authMiddleware, RelatorioController_1.RelatorioController.getSugestoesPagamentoEntreGrupos);
router.get('/grupos/:id/sugestoes-pagamento', auth_1.authMiddleware, RelatorioController_1.RelatorioController.getSugestoesPagamento);
router.post('/despesas/:despesaId/participacoes', auth_1.authMiddleware, ParticipacaoController_1.ParticipacaoController.toggle);
router.post('/despesas/:despesaId/recalcular', auth_1.authMiddleware, ParticipacaoController_1.ParticipacaoController.recalcular);
router.get('/grupos/:eventoId/grupos-participantes', auth_1.authMiddleware, GrupoParticipantesController_1.GrupoParticipantesController.getAll);
router.get('/grupos/:eventoId/grupos-participantes/:id', auth_1.authMiddleware, GrupoParticipantesController_1.GrupoParticipantesController.getById);
router.post('/grupos/:eventoId/grupos-participantes', auth_1.authMiddleware, GrupoParticipantesController_1.GrupoParticipantesController.create);
router.put('/grupos/:eventoId/grupos-participantes/:id', auth_1.authMiddleware, GrupoParticipantesController_1.GrupoParticipantesController.update);
router.delete('/grupos/:eventoId/grupos-participantes/:id', auth_1.authMiddleware, GrupoParticipantesController_1.GrupoParticipantesController.delete);
router.post('/grupos/:eventoId/grupos-participantes/:grupoId/participantes', auth_1.authMiddleware, GrupoParticipantesController_1.GrupoParticipantesController.adicionarParticipante);
router.delete('/grupos/:eventoId/grupos-participantes/:grupoId/participantes/:participanteId', auth_1.authMiddleware, GrupoParticipantesController_1.GrupoParticipantesController.removerParticipante);
router.get('/grupos-maiores', auth_1.authMiddleware, GrupoMaiorController_1.GrupoMaiorController.getAll);
router.get('/grupos-maiores/recentes', auth_1.authMiddleware, GrupoMaiorController_1.GrupoMaiorController.getRecentes);
router.get('/grupos-maiores/:id', auth_1.authMiddleware, GrupoMaiorController_1.GrupoMaiorController.getById);
router.post('/grupos-maiores', auth_1.authMiddleware, GrupoMaiorController_1.GrupoMaiorController.create);
router.put('/grupos-maiores/:id', auth_1.authMiddleware, GrupoMaiorController_1.GrupoMaiorController.update);
router.delete('/grupos-maiores/:id', auth_1.authMiddleware, GrupoMaiorController_1.GrupoMaiorController.delete);
router.post('/grupos-maiores/:id/grupos', auth_1.authMiddleware, GrupoMaiorController_1.GrupoMaiorController.adicionarGrupo);
router.delete('/grupos-maiores/:id/grupos', auth_1.authMiddleware, GrupoMaiorController_1.GrupoMaiorController.removerGrupo);
router.post('/grupos-maiores/:id/participantes', auth_1.authMiddleware, GrupoMaiorController_1.GrupoMaiorController.adicionarParticipante);
router.delete('/grupos-maiores/:id/participantes/:participanteId', auth_1.authMiddleware, GrupoMaiorController_1.GrupoMaiorController.removerParticipante);
router.get('/grupos-maiores/:id/participantes', auth_1.authMiddleware, GrupoMaiorController_1.GrupoMaiorController.obterTodosParticipantes);
// Rota pública para reivindicar participação (requer autenticação após cadastro)
router.post('/public/eventos/:token/reivindicar', auth_1.authMiddleware, PublicEventoController_1.PublicEventoController.reivindicarParticipacao);
// Rotas administrativas (requerem autenticação e role ADMIN)
router.get('/admin/estatisticas', auth_1.authMiddleware, requireAdmin_1.requireAdmin, AdminController_1.AdminController.getEstatisticasGerais);
router.get('/admin/estatisticas/usuarios', auth_1.authMiddleware, requireAdmin_1.requireAdmin, AdminController_1.AdminController.getEstatisticasUsuarios);
router.get('/admin/estatisticas/eventos', auth_1.authMiddleware, requireAdmin_1.requireAdmin, AdminController_1.AdminController.getEstatisticasEventos);
router.get('/admin/estatisticas/despesas', auth_1.authMiddleware, requireAdmin_1.requireAdmin, AdminController_1.AdminController.getEstatisticasDespesas);
router.get('/admin/estatisticas/acessos', auth_1.authMiddleware, requireAdmin_1.requireAdmin, AdminController_1.AdminController.getEstatisticasAcessos);
router.get('/admin/usuarios', auth_1.authMiddleware, requireAdmin_1.requireAdmin, AdminController_1.AdminController.getAllUsuarios);
router.get('/admin/eventos', auth_1.authMiddleware, requireAdmin_1.requireAdmin, AdminController_1.AdminController.getAllEventos);
exports.default = router;
